# ロール定義フォーマットガイド

## 目的・適用対象

**目的**: ロール定義ファイルの構成を統一し、Claude がロールのスコープ・作業フロー・制約を素早く把握できるようにする。

**適用対象**:
- `dev-process-improvement/.claude/rules/*.md` — プロセス改善システムのロール（l1-manager, l2-worker, l2-evaluator, triage）
- `roles/*.md` — ai-driven-dev-patterns のエージェントロール（bug_fixer, reviewer など）

新しいロール定義ファイルを作成する際は、このガイドを雛形として使うこと。

---

## セクション構成

### 必須セクション

すべてのロール定義ファイルに含めること。

#### `## あなたの役割`

このロールが何をするかを1〜2文で説明する。

```markdown
## あなたの役割

あなたは〇〇セッションです。〜〜を担当します。
```

#### `## 作業フロー`

やるべき作業を番号付きステップで列挙する。各ステップには必要な詳細（参照ファイル・コマンド例など）を含める。

```markdown
## 作業フロー

1. `02_tasks.md` を読み、全タスクを把握する
2. 壁打ちフェーズを実施する
3. タスクを実施し、`03_work_log.md` に記録する
```

#### `## やること`

このロールが担う責任を箇条書きで明示する。スコープの内側を定義する。

```markdown
## やること

- タスクを実行し、成果物を作成する
- 作業履歴を記録する
- 発見した課題を起票する
```

#### `## やらないこと`

このロールの範囲外の作業を箇条書きで明示する。スコープの外側を定義する。担当ロールがある場合は明記する。

```markdown
## やらないこと

- L1 の成果物（00, 01, 08）は編集しない（読み取りのみ）
- 自己判断で次のタスクを選んで継続実行しない（→ L1 に委ねる）
```

---

### 任意セクション

必要に応じて追加する。

#### `## 担当ファイル`

複数ファイルへのアクセス権限を管理する場合に追加する。テーブル形式で記載。

```markdown
## 担当ファイル

| ファイル | 操作 |
|---------|------|
| `02_tasks.md` | 読み取りのみ（チェックボックス更新は可） |
| `03_work_log.md` | 追記・編集 |
| `07_issues.md` | 追記 |
```

#### `## 停止ルール`

作業を中断すべき条件が明確な場合に追加する。

```markdown
## 停止ルール

コンテキストの浪費を防ぐため、以下の状況では作業を止めて起票する。

- 想定外のファイル調査が必要になった
- 判断に迷い、進めると計画から逸脱するリスクがある
```

---

## セクション順序

以下の順に配置する。

```
1. あなたの役割（必須）
2. 作業フロー（必須）
3. やること（必須）
4. やらないこと（必須）
5. 担当ファイル（任意）
6. 停止ルール（任意）
7. ロール固有の追加セクション（任意）
```

---

## YAML フロントマター

Claude Code の `paths:` バインドを使う場合のみ追加する。不要なら省略してよい。

```yaml
---
paths: "対象パスの glob パターン"
---
```

例: `l2-worker.md` は `initiatives/**/03_work_log.md` などにバインドされている。

---

## テンプレート

新規ロール作成時のコピー元として使うこと。

```markdown
---
paths: ""  # 必要なら記載、不要なら削除
---
# {ロール名}

## あなたの役割

あなたは〇〇セッションです。〜〜を担当します。

---

## 作業フロー

1. 〜〜する
2. 〜〜する
3. 〜〜する

---

## やること

- 〜〜する
- 〜〜する

## やらないこと

- 〜〜は行わない
- 〜〜は行わない（→ {担当ロール} が担当）

---

## 担当ファイル（任意）

| ファイル | 操作 |
|---------|------|
| `file.md` | 読み取りのみ |

---

## 停止ルール（任意）

以下の状況では作業を止めて起票する。

- 条件A
- 条件B
```
