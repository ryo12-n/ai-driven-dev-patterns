# CLAUDE.md

<!-- このリポジトリでClaude Codeを使う際の共通ルール・前提を記載する -->
<!-- 例: 設計書の書き方ルール、コード禁止ポリシー、openspec参照指示など -->

## 壁打ち・相互理解確認ルール

### 適用対象

以下に該当する「複雑なタスク」にのみ適用する。

- 設計・アーキテクチャの判断を伴う作業
- 複数ファイルにまたがる変更
- 要件が曖昧・解釈が複数ありうる依頼
- 仕様書・ドキュメントの新規作成・大幅改訂

単純な修正（誤字修正・1箇所の変更・明確な指示）は確認フェーズを省略して即実行してよい。

### タスク受領時の確認フェーズ

複雑なタスクと判断した場合、実装に着手する前に以下を提示する。

1. **理解のサマリー** — タスクの目的・スコープ・完了条件を自分の言葉でまとめる
2. **不明点の列挙** — 曖昧な箇所や判断が必要な選択肢を箇条書きで質問する

### 確認の定型表現（例）

- 「〜という理解で合っていますか？」
- 「〜と〜のどちらを意図していますか？」
- 「スコープは〜までで良いですか？」

### 柔軟性

ユーザーが「確認不要、すぐ進めて」と明示した場合は確認フェーズをスキップして実行してよい。

### 実行中のチェックイン

複数フェーズにわたる作業は、フェーズ境界で進捗を共有し、想定外の判断が必要になったら都度確認する。

### 実行後の確認

完了後は結果のサマリーを提示し、意図と一致しているか確認する。

---

## OpenSpec 編集上の注意

`openspec/config.yaml` を直接編集するときは以下に注意すること。

- `rules:` セクションの文字列値に日本語が含まれる場合はシングルクォートで囲むこと
  - 例: `- '日本語のルール文字列'`（ダブルクォートは YAML パースエラーになる場合がある）
