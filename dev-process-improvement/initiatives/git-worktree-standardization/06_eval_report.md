# 評価レポート: git worktree によるClaude並列開発の標準化検討

## 1. 評価サマリ

ガイドライン文書（`docs/git-worktree-guideline.md`）は、`01_plan.md` の成功基準5項目をすべて満たしており、全体として十分な品質を持つ。worktree 機能の仕様・制約の調査は網羅的で、利用判断基準は具体的なシナリオとフローチャートで明確化されている。ロックベース方式との比較は10軸の比較表で公平に分析されており、現在の L1/L2 ワークフローとの整合性も確認できた。文書構成は論理的で可読性が高い。一方、判断フローチャートの一部にテキスト表現の限界による可読性の課題、および Agent Teams 機能への言及不足といった改善余地がある。これらは次フェーズの実運用適用時に対処すれば足りる程度の課題であり、現フェーズの通過を妨げるものではない。

## 2. 評価結果

| # | 評価項目 | 判定基準 | 結果 | 判定 |
|---|---------|---------|------|------|
| 1 | 調査の網羅性 | T-001 の5つの調査観点すべてについてガイドライン文書内に対応する記述があること。情報源が明記されていること | T-001 調査観点5項目（worktree 作成・削除タイミング、ブランチ返却方法、自動クリーンアップ、親プロセスとの関係、既知の制約）すべてがセクション1・7に反映。公式ドキュメント URL 2件が参照資料として記載。制約事項は技術的制約7項目+運用上の注意事項5項目 | 合格 |
| 2 | 判断基準の明確さ | 判断フローチャートが Yes/No で分岐し各分岐先に明確な結論があること。使うべき/使わないべき場面がそれぞれ3つ以上の具体的シナリオで例示されていること | 「使うべき場面」4シナリオ、「使わないべき場面」5シナリオを表形式で提示。判断フローチャートは4つの判断軸（読み取り専用か、並列ファイル編集か、リポジトリサイズ、タスク間依存関係）で構成。ただし複合ケースの判断パスが不明確（課題 E-001） | 合格（軽微改善余地あり） |
| 3 | 比較分析の妥当性 | 比較表が5軸以上で構成され両方式のメリット・デメリットが記載されていること。PoC の記述と矛盾する事実誤認がないこと。方式選択の指針が記載されていること | 10軸（+Claude Code 統合の軸で11軸）の比較表を作成。PoC の `lock_protocol.md` の記述（テキストファイルベースのロック、push 時の競合検出、後から来たエージェントが引き下がる原則）と矛盾なし。worktree 適/ロック適の各ケースおよび併用可能性を記載 | 合格 |
| 4 | ワークフローとの整合性 | 現在のワークフローとの関係が正確に記述されていること。将来の影響箇所が一覧化されていること。worktree 不要という結論に論理的根拠があること | `docs/workflow.md` の L1→L2-worker→L2-evaluator の順次起動フロー、ファイル所有権テーブルと一致。worktree 不要の根拠3点（順次実行モデル、ファイル所有権ルール、文書中心の作業）は `l1-manager.md` の「L2-worker が完了してから L2-evaluator を起動すること（並列起動しない）」の記述と整合。影響箇所6項目を影響度付き表で一覧化 | 合格 |
| 5 | 文書の構成・可読性 | 7セクションが論理的順序で配置されていること。各セクションが独立参照可能であること。表・図が適切に使われていること | セクション構成は「概要→判断基準→比較→現状→将来→関連施策→制約」と、読者が段階的に理解を深められる配置。表5箇所、テキストフローチャート2箇所、コードブロック2箇所を活用。文書冒頭に位置づけとバージョン前提の注記あり。セクション4と5に一部記述重複あり（課題 E-002） | 合格（軽微改善余地あり） |

## 3. 計画の成功基準に対する達成度

| # | 成功基準 | 達成度 | 根拠 |
|---|---------|--------|------|
| SC-1 | `isolation: "worktree"` 機能の仕様・制約が調査結果としてまとめられている | 達成 | セクション1に CLI レベル（`--worktree`）とサブエージェントレベル（`isolation: worktree`）の仕様・ライフサイクルを記載。セクション7に技術的制約7項目・運用上の注意事項5項目を記載 |
| SC-2 | worktree を使う場面と使わない場面の判断基準が明確に文書化されている | 達成 | セクション2に「使うべき場面」4シナリオ・「使わないべき場面」5シナリオを表形式で提示。判断フローチャートで意思決定パスを図示 |
| SC-3 | 参考 PoC のロックベース方式との比較分析が含まれている | 達成 | セクション3に PoC の概要、10軸比較表、方式選択の指針を記載。「排他的ではなく補完的」という結論を具体例付きで記載 |
| SC-4 | 現在の L1/L2 ワークフローとの関係が整理されている | 達成 | セクション4に現在のワークフロー構造図、worktree 不要の根拠3点、将来の影響箇所6項目の表を記載 |
| SC-5 | 協調プロトコル施策との接続点が明記されている | 達成 | セクション6に commit/lock/test の各プロトコルと worktree の関係を表形式で整理。「インフラ層 vs アプリケーション層」のレイヤー関係を明記。`initiatives/coordination-protocol/00_proposal.md` への参照を含む |

## 4. 発見された課題・改善提案

### 評価者発見の課題

#### E-001: 判断フローチャートのテキスト表現の限界

**観点**: 判断基準の明確さ（評価項目2）
**内容**: セクション2の判断フローチャートはテキストベースのインデント図で表現されているが、分岐パスが複雑で、すべてのケースが網羅されているかの検証が視覚的に困難である。具体的には、「リポジトリサイズ」と「タスク間の依存関係」の分岐が、「複数エージェントが並列にファイルを編集するか？」の分岐と独立して配置されており、これらが組み合わさるケース（例: 大規模モノレポで独立タスクを並列実行したい場合）の判断パスが不明確。
**改善提案**: 将来のルールファイル組み込み時に、Mermaid 図などの構造化された図で判断フローを再構成することを推奨する。現時点ではテキスト表現でも実用上の大きな問題はない。
**重大度**: 低（現フェーズの通過を妨げない）
**施策横断性**: なし（本施策内で完結する改善）

#### E-002: セクション4とセクション5の記述重複

**観点**: 文書の構成・可読性（評価項目5）
**内容**: セクション4「将来の並列化で影響を受ける箇所」の表と、セクション5「段階的な導入ロードマップ」のステージ2・3の「必要な準備」に、作業ログの構造見直し・マージ戦略の定義といった重複する記述がある。
**改善提案**: セクション4は「現在のワークフローへの影響分析」に集中し、将来の対策は「セクション5を参照」とすることで重複を解消できる。次回の文書改訂時に検討を推奨する。
**重大度**: 低（可読性への影響は軽微）
**施策横断性**: なし（本施策内で完結する改善）

#### E-003: Agent Teams 機能への言及不足

**観点**: 調査の網羅性（評価項目1）
**内容**: 参考 PoC の `docs/reference.md` では、Claude Code の公式 Agent Teams 機能（実験的）が方式Cとして紹介されている。この機能はチームメイト間で直接メッセージをやり取りでき、タスクの依存関係を自動管理する機能を持ち、worktree ベースの隔離と関連する。ガイドライン文書ではこの機能への言及がない。
**改善提案**: Agent Teams 機能は実験的機能であり、本ガイドラインのスコープ（worktree による隔離パターンの標準化）とは直接的には異なるレイヤーの機能である。ただし、将来の拡張方針（セクション5）において、worktree + Agent Teams の組み合わせパターンを「参考情報」として一言触れておくと、読者の選択肢の理解が広がる。次回改訂時の検討事項として記録する。
**重大度**: 低（現フェーズの通過を妨げない。本ガイドラインのスコープ外の機能）
**施策横断性**: あり（将来の並列化施策全般に関連する知見）

### 実施ワーカー未転記課題

- **件数**: 0件
- **課題一覧**: なし
- `07_issues.md` に実施ワーカー（L2-worker）による未転記課題は存在しない。L2-worker は T-005 で確認を完了しており、「施策をまたぐ課題は発見されなかった」旨が記録されている。対応不要。

## 5. 次フェーズへの推奨

**推奨: フェーズ1を通過とする（進めるべき）。**

根拠:
1. 成功基準5項目すべてが達成されている
2. 発見された課題（E-001〜E-003）はいずれも重大度「低」であり、現フェーズの品質基準を満たしている
3. ガイドライン文書は参考情報としての位置づけが明確であり、将来のルールファイル組み込み時に改善余地のある箇所を文書内で自己認識している（文書冒頭の注記）
4. 協調プロトコル施策（`initiatives/coordination-protocol/`）が本ガイドラインの成果を前提条件として取り込む設計になっており、接続点が明確に定義されている

次施策への申し送り事項:
- 本ガイドラインのセクション6（協調プロトコル施策との接続点）を起点として、commit/lock/test の各プロトコル設計を進めること
- E-003 で指摘した Agent Teams 機能の存在を、並列化方式の選択肢として認識しておくこと
- ガイドライン文書の改善（E-001 の判断フローチャート図化、E-002 の重複解消）は、ルールファイル組み込み時にあわせて実施することを推奨

---
**作成者**: L2（評価）
**作成日**: 2026-02-25
