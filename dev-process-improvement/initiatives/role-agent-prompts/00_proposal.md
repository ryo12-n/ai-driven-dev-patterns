# 改善施策提案: ロール別エージェントプロンプト整備

## 背景・課題

現在の `.claude/rules/` にはロール別ルールファイル（l1-manager.md / l2-worker.md / l2-evaluator.md）が存在するが、以下の問題がある。

1. **paths: フロントマターに依存した遅延ロード**: 対象ファイルを編集し始めてからルールが読み込まれるため、セッション開始時点では役割コンテキストが十分に与えられない
2. **記述が最小限**: ルールと禁止事項の列挙にとどまり、典型的な判断フロー・作業パターンの例示が不足している
3. **セッション開始の標準化不足**: ユーザーが手動で「あなたはL1セッションです」と伝える方式に依存しており、セッション初期の振る舞いが安定しない

参照: `refs/ai-driven-development-poc/.claude/roles/` では、各ロールが自律的に動ける詳細なプロンプト（手順・例示・判断フロー・トラブルシューティング）を持っており、出力品質が安定している。

## 目標

- L1・L2の各ロールが、セッション開始直後から正しい振る舞いができるよう、ロール別プロンプトを充実させる
- 典型的な作業フロー・判断パターンを例示として組み込み、曖昧な判断によるアウトプットのばらつきを減らす

## スコープ

### やること

- 現在の `.claude/rules/l1-manager.md` / `l2-worker.md` / `l2-evaluator.md` を分析し、不足要素を特定する
- poc参照実装のパターンから本施策に転用可能な構造・記法を抽出する
- 各ロールの改善版ドラフトを `initiatives/role-agent-prompts/drafts/` に作成する
- ゲートレビュー通過後に `.claude/rules/` の各ファイルを改善版で置き換える

### やらないこと

- `triage.md` の改善（別施策として検討）
- CLAUDE.md 本体の大規模改訂
- 新規ロールの追加
- ロック・コミットプロトコルなど協調プロトコルの整備（別バックログ施策）

## 期待される効果

- L1/L2 各セッションの初動品質が安定し、ユーザーの補足指示が減る
- 判断迷いによる不要なチェックインや誤ったアウトプットが減少する
- 新しいユーザーがセッションを開始するときのオンボーディングコストが下がる

## リスク

| リスク | 影響度 | 対策 |
|--------|--------|------|
| ドラフトがプロンプトとして過長になり読み込みコストが増加する | 中 | 構造化・折りたたみ可能な記述でバランスを取る |
| 改善版が既存のルールと矛盾する記述を含む | 中 | L2-evaluator が既存ルールとの整合性を評価項目に含める |

---
**起票者**: L1
**起票日**: 2026-02-23
**ステータス**: 起票 → 承認済 → 実施中 → 評価中 → 完了
