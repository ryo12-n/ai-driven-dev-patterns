# 作業レポート: コード開発ワークフロー設計の探索（フェーズ1）

## サマリ

フェーズ1（概要設計）の全5タスク（T-001〜T-005）を完了した。`roles/` 配下の既存7ロールと `_base/common.md` を全て読了し、各ロールの開発ワークフローへの適合度を分析した。TDD分離は「条件付き分離」を推奨方針とし、不足ロールとして dev_manager の新規定義が必要であることを確認した。これらの分析結果を統合した概念設計ドキュメント `docs/design/dev-workflow-overview.md` を作成した。mermaid 図によるワークフロー全体像、施策管理ワークフローとの差異、ロール間データフロー、分析結果サマリーの4項目を網羅している。

## タスク実績

| ID | タスク | 計画 | 実績 | 差異・備考 |
|----|--------|------|------|-----------|
| T-001 | 既存7ロールの開発ワークフロー適用性分析 | 7ロール+common.md を読み、4観点で分析 | 7ロール+common.md を全て読了し、4観点（責務・適合度・修正点・依存関係）で分析完了 | 差異なし。適合度は高4・中2・低1 |
| T-002 | TDD方式での実装・テスト役割分離の評価 | 4観点で評価し推奨方針を明記 | メリット5点・デメリット5点を整理し「条件付き分離」を推奨方針として明記 | 差異なし |
| T-003 | 不足ロールの要件整理 | 3つの検討対象について必要性判断と責務案 | designer（要検討）、dev_manager（必要）、その他（不要）の判断を記載。dev_manager の責務案を5項目で整理 | 差異なし |
| T-004 | コード開発ワークフロー概念設計の作成 | `docs/design/dev-workflow-overview.md` 作成。mermaid図・差異説明・データフロー・サマリーの4項目を含む | 設計ドキュメントを作成。mermaid図3点（ロール構成図・標準開発フロー・施策管理連携シーケンス図）、施策管理との比較表、データフローテーブル、分析サマリーを網羅 | 差異なし |
| T-005 | 07_issues.md 未転記課題の確認・転記 | 全課題に転記済み/転記不要の判断を付与 | 作業中に発見した3件の課題を起票し、全3件を「転記不要」と判断（施策内で完結する課題のため） | 差異なし。CSV転記対象なし |

## 成果物一覧

- `docs/design/dev-workflow-overview.md` — コード開発ワークフロー概念設計（新規作成）
- `03_work_log.md` — 壁打ちフェーズ記録 + T-001〜T-005 の作業ログ
- `07_issues.md` — 課題メモ3件（全件転記不要判断済み）

## 発生した課題

- 全ロール共通: テスト実行コマンドが未確定（転記不要: 後続施策で対応）
- ロール間タスク起票の具体的手順が未定義（転記不要: フェーズ2 T-007 で対応）
- dev_manager ロールの新規定義が必要（転記不要: 後続施策で対応）

いずれも施策をまたいで再発しうる課題ではなく、本施策またはその後続施策のスコープ内で完結するため、CSV転記は行わなかった。

## 所感・次フェーズへの申し送り

- 既存7ロールは全体的に開発ワークフローへの適合度が高く、大きな設計変更なしにワークフローに組み込める見通し。修正点はあるが軽微なものが多い
- 最大の設計判断は dev_manager ロールの導入。施策管理 L1 との責務分界を明確にすることが重要
- TDD分離の「条件付き分離」方針は合理的だが、分離トリガーの定量的な判断基準はフェーズ2で具体化が必要
- designer ロールの要否は openspec 連携（ISS-006）の確定に依存するため、フェーズ2でも保留の見込み
- フェーズ2では主要3シナリオ（新機能開発・バグ修正・リファクタリング）の詳細フロー設計と、ロール間連携プロトコル設計が中心課題になる

---

# 作業レポート: コード開発ワークフロー設計の探索（フェーズ2）

## サマリ

フェーズ2（詳細設計）の全4タスク（T-006〜T-009）を完了した。フェーズ1の概念設計をベースに、主要3シナリオ（新機能開発・バグ修正・リファクタリング）の詳細ワークフローを設計し、mermaid sequence 図・ロール起動順序・入力/出力・分岐条件を定義した。TDD分離トリガーの定量的判断基準（E-ISS-002対応）として5つの閾値を設定した。ロール間連携プロトコル（タスク引き渡し・成果物受け渡し・エスカレーション・コンテキスト共有）を設計し、既存7ロール + common.md の修正提案と新規ロール dev_manager の要件定義を作成した。全内容を `docs/design/dev-workflow-detail.md` に統合した。

## タスク実績

| ID | タスク | 計画 | 実績 | 差異・備考 |
|----|--------|------|------|-----------|
| T-006 | 主要シナリオ別ワークフロー詳細設計 | 3シナリオの mermaid sequence 図・起動順序・入力/出力・分岐条件を定義。TDD分離トリガーの定量的基準を含む | 3シナリオ全てについて sequence 図・起動順序テーブル・入力/出力テーブル・分岐条件テーブルを作成。TDD分離の定量的閾値5項目と判断フローチャートを定義 | 差異なし。差し戻し回数上限（最大3回）を全シナリオ共通で設定 |
| T-007 | ロール間連携プロトコル設計 | 4項目（引き渡し・受け渡し・エスカレーション・コンテキスト共有）を設計 | hub-and-spoke方式の引き渡し、gitコミット+ファイルパス参照の受け渡し、3段階エスカレーション、4種の共有手段を設計。テンプレート定義含む | 差異なし |
| T-008 | 既存ロール修正提案 + 統合 | 各ロールの修正提案、dev_manager 要件定義、common.md 修正提案。T-006〜T-008 を `docs/design/dev-workflow-detail.md` に統合 | 全7ロール + common.md の修正提案（合計20箇所）。dev_manager の要件定義（責務7項目・やること/やらないこと・L1との責務分界）。全内容を1ファイルに統合 | 差異なし |
| T-009 | 07_issues.md 未転記課題の確認・転記 | 全課題に転記済み/転記不要の判断を付与 | 全5件を確認。全件「転記不要」判断済み。フェーズ2で新規課題なし | 差異なし。CSV転記対象なし |

## 成果物一覧

- `docs/design/dev-workflow-detail.md` -- コード開発ワークフロー詳細設計（新規作成。T-006〜T-008 の全内容を統合）
- `dev-process-improvement/initiatives/コード開発ワークフロー設計の探索/03_work_log.md` -- フェーズ2の作業ログ追記
- `dev-process-improvement/initiatives/コード開発ワークフロー設計の探索/07_issues.md` -- 全5件の転記判断確認済み（変更なし）

## 付帯条件への対応

| 付帯条件 | 対応内容 | 状態 |
|---------|---------|------|
| E-ISS-001: 成果物パスはリポジトリルートからの相対パスで統一 | `docs/design/dev-workflow-detail.md` 冒頭にパス表記ルールを明記。全パスをリポジトリルート起点で記載 | 対応済み |
| E-ISS-002: TDD分離トリガーの判断基準を定量的に定義 | セクション2 で5つの定量的閾値（ファイル数>=3、循環的複雑度>=10、分岐数>=5、セキュリティ要件、カバレッジ<50%）と判断フローチャートを定義。フォールバック基準も用意 | 対応済み |

## 発生した課題

なし。フェーズ2の作業中に新たな課題は発見されなかった。

## 所感・次施策への申し送り

- 3シナリオの詳細設計はフェーズ1の概念設計と整合しており、ロール起動順序・分岐条件に矛盾はない
- TDD分離の定量的基準は McCabe の循環的複雑度基準等の客観的指標を採用。ただし、プロジェクト固有の実測データが蓄積されれば閾値の調整が望ましい
- dev_manager ロールは施策管理 L1 の common.md パターンを踏襲しつつ、開発タスク固有のオーケストレーション（TDD判断・レビュー合否・差し戻し）を追加。後続施策でのロール定義ファイル作成は比較的スムーズに進む見込み
- ロール間連携プロトコルのテンプレート（タスク指示・完了報告・ブロック報告）は、実際の運用で改善の余地がある。後続施策で実装後に実使用フィードバックを取ることを推奨
- 既存ロール修正提案は全て後方互換性を維持する追記・追加が中心。既存のワークフロー（施策管理 L1/L2）には影響しない

---
**作成者**: L2（実施）
**作成日**: 2026-03-01
