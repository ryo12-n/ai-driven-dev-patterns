# 改善施策提案: コード開発ワークフロー設計の探索

## 背景・課題

L2 実施ワーカーの作業負荷が高く、実装・テスト・設計・レビューなど複数の責務を1つのロールで担っている。`roles/` には7つの専門ロール（feature_builder, test_writer, reviewer, bug_fixer, refactorer, optimizer, documentarian）が定義済みだが、これらを開発ワークフローとしてどう連携させるかは未定義である。

以下の論点を探索・評価する必要がある。

- **既存ロールの活用可否**: `roles/` 配下の7ロールのうち、開発ワークフローに組み込めるものはどれか
- **TDD での役割分離の有効性**: 実装担当（feature_builder）とテスト担当（test_writer）を分けて連携させることが品質・効率の面で有効か
- **不足ロールの特定**: 設計専門ロール（現在 openspec 内に暗黙的に存在）、開発マネージャーロール（施策管理 L1 とは別）が必要か
- **開発セッションのワークフロー概念設計**: 施策管理ワークフロー（L1/L2）とは活動ディレクトリ・目的が異なるため、別のワークフロー定義が必要

## 目標

1. 既存7ロールの開発ワークフローへの適用可否を評価し、各ロールの適合度を明確にする
2. TDD 方式での実装・テスト役割分離の有効性を、メリット/デメリット/適用ケースの観点で評価する
3. 不足ロール（設計者、開発マネージャー等）の必要性と責務案を整理する
4. コード開発セッションのワークフロー概念設計を mermaid 図を含む設計ドキュメントとして作成する

## スコープ
### やること
- `roles/` 配下の7ロール + `_base/common.md` の分析・評価
- TDD ワークフローにおける役割分離の評価
- 不足ロール（設計者、開発マネージャー）の要件整理
- 概要設計ドキュメント（`docs/design/dev-workflow-overview.md`）の作成
- 詳細設計ドキュメント（`docs/design/dev-workflow-detail.md`）の作成
- 既存ロールの修正提案（ドキュメントレベル）

### やらないこと
- コード実装（ロール定義ファイルの実際の修正は後続施策で実施）
- 施策管理ワークフロー（dev-process-improvement の L1/L2）の変更
- OpenSpec ワークフローの変更
- CI/CD パイプラインの設計

## 期待される効果

- 既存ロールの開発ワークフローへの適用可否が明確になり、後続施策「コード開発ワークフロー・ロール定義の実装」のインプットが揃う
- TDD 方式での役割分離の推奨方針が決まり、開発品質の向上が見込める
- 不足ロールの要件が整理され、追加ロール定義の方向性が明確になる
- ワークフロー概念設計により、コード開発セッションの標準化の土台ができる

## リスク

| リスク | 影響度 | 対策 |
|--------|--------|------|
| 探索範囲が広がりすぎ、概念設計の粒度が粗くなる | 中 | フェーズ1（概要設計）とフェーズ2（詳細設計）に分け、フェーズ1でスコープを確定してからフェーズ2に進む |
| 既存ロール定義が開発ワークフローの前提と合わない | 中 | ロール修正提案をスコープに含め、必要な修正を設計レベルで明記する |
| 施策管理ワークフローとの境界が曖昧になる | 低 | 壁打ちで「独立した仕組み」と確認済み。設計ドキュメントに差異を明記する |

## 壁打ちの背景

フェーズ0の壁打ちで以下の意思決定を行った。

1. **成果物の配置先**: 施策管理のテンプレートファイル（03〜08）とは別に、`docs/design/` に設計ドキュメントを配置する。施策の枠組みは dev-process-improvement で管理しつつ、成果物は汎用的な場所に置く
2. **探索の深さ**: まず概要設計（フェーズ1）でワークフロー全体像を作り、その後詳細設計（フェーズ2）でシナリオ別フロー・ロール連携プロトコルまで踏み込む
3. **既存ロールの変更可否**: `roles/` 配下のロール定義の修正提案もスコープに含める。ただし実際のファイル修正は後続施策で実施する
4. **施策管理との関係**: コード開発ワークフローは施策管理（dev-process-improvement）とは独立した仕組みとして設計する

## 備考・設計パターン

- 本施策は「探索」であり、コード実装は伴わない
- 成果物は設計ドキュメント2件（概要設計 + 詳細設計）
- 後続施策「コード開発ワークフロー・ロール定義の実装」（バックログ登録済み）のインプットとなる
- 参照: `roles/` 配下の7ロール定義、`roles/_base/common.md`、`dev-process-improvement/.claude/rules/` の L1/L2 定義

---
**起票者**: L1
**起票日**: 2026-03-01
**ステータス**: 完了
