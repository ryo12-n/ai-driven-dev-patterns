# 実施計画: シナリオ別セッション運用フロー設計

## フェーズ構成

| フェーズ | 内容 | 成功基準 |
|---------|------|----------|
| Phase 1 | セッションフレームワーク & ディスパッチャー設計 | ライフサイクル状態図、ディスパッチャーフロー図、エントリーポイント仕様、セッション型レジストリが定義されている |
| Phase 2 | シナリオ別セッションフロー設計 | 全5シナリオの mermaid シーケンス図・ロール構成表・I/O仕様・分岐条件が定義されている |
| Phase 3 | 横断的関心事 & 統合 | 状態永続化・コンテキスト引き継ぎ・エラー回復の設計、デザインデルタ表、次施策リンクが完成している |

## 各フェーズの詳細

### Phase 1: セッションフレームワーク & ディスパッチャー設計

5シナリオに共通する土台を設計する。個別シナリオの前に共通フレームワークを確立することで、Phase 2 での設計作業を効率化する。

**設計対象**:
1. **セッションライフサイクルモデル**: セッションの汎用的な状態遷移（起動→初期化→実行→レビュー→完了）を mermaid 状態図で定義
2. **セッションディスパッチャー/ルーター**: 人間の意図をシナリオに分類し、適切なセッション構成を選択するロジック。意図分類基準・フロー図・セッション型レジストリを含む
3. **人間エントリーポイント & dev_manager 起動再設計**: L1→dev_manager の結合を外し、人間→dev_manager の直接エントリーに変更。入力形式・起動トリガー・初期コンテキスト設定を定義

### Phase 2: シナリオ別セッションフロー設計

5シナリオそれぞれの詳細フローを設計する。Phase 1 の共通フレームワーク上に各シナリオ固有の設計を積む。

**設計対象（シナリオごと）**:
- mermaid シーケンス図（ロール間のやり取り・分岐を可視化）
- ロール構成表（起動するロール・起動タイミング・依存関係）
- 入出力仕様（インプット・アウトプット・中間成果物）
- 分岐条件（正常系・異常系・品質ゲート）
- ハイブリッドレビュー方式の仕様（軽量レビュー・独立評価の判定基準テーブル）

### Phase 3: 横断的関心事 & 統合

セッション横断の共通設計と、既存ドキュメントとの整合性を確保する。

**設計対象**:
1. **横断的関心事**: セッション間の状態永続化、コンテキスト引き継ぎ、エラー回復の設計
2. **統合マッピング**: 新規設計と既存2ドキュメント（`dev-workflow-overview.md`、`dev-workflow-detail.md`）のデザインデルタ表
3. **最終ドキュメント整備**: `session-operation-flow.md` の全体構成確認、「次ステップ」セクション追加

## 成功基準（全体）

1. `docs/design/session-operation-flow.md` が5シナリオすべてを mermaid 図付きでカバーしている
2. 人間エントリーポイントが L1 非依存で定義されている
3. ディスパッチャーの分類基準が明確・網羅的である（5シナリオ + 「該当なし」ケースをカバー）
4. ハイブリッドレビュー基準が定量的/チェックリスト形式で定義されている
5. 横断的関心事（状態永続化・コンテキスト引き継ぎ・エラー回復）が設計されている
6. 既存2ドキュメントとのデザインデルタが明示されている
7. 後続施策「コード開発ワークフロー・ロール定義の実装」のインプットとして十分な詳細度がある

## リソース・前提条件

- 参照ドキュメント: `docs/design/dev-workflow-overview.md`、`docs/design/dev-workflow-detail.md`
- 前施策のゲートレビュー: `initiatives/_archive/コード開発ワークフロー設計の探索/08_gate_review.md`（知見#9, #10）
- 既存ロール定義: `roles/*.md`（7ロール + `_base/common.md`）
- 施策管理との独立性を前提とする（dev-process-improvement は管理手段であり、開発フロー自体は独立）

## リスクと対策

| リスク | 発生確率 | 影響 | 対策 |
|--------|---------|------|------|
| 5シナリオの設計でスコープが膨張する | 中 | 中 | Phase 1 で共通フレームワークを確立し、各シナリオはテンプレート構造を共有。シナリオ間で共通化できる部分を積極的に抽出する |
| 既存設計ドキュメントとの不整合が大きくなる | 中 | 高 | Phase 3 でデザインデルタ表を作成し明示的に差分管理。既存ドキュメントの修正は本施策では行わず、デルタとして記録する |
| シナリオ1（要件定義→設計）の既存ロール不足 | 中 | 中 | 不足するロール/能力を設計として文書化。実装は後続施策に委ねる |
| dev_manager 再設計の波及範囲が拡大する | 低 | 低 | エントリーポイント（起動トリガー源）のみ変更。内部責務・ハブ&スポーク構造は不変と明記する |

---
**作成者**: L1
**作成日**: 2026-03-01
**最終更新**: 2026-03-01
