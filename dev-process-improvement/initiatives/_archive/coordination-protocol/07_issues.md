# 課題メモ（施策内バッファ）: 協調プロトコル整備（commit/lock/test）

> **このファイルの役割**: 施策実施中に気づいた課題・知見・リスクの一時メモ置き場。
> 施策完了（または定期レビュー）時に `dev-process-improvement/プロセス改善_課題管理.csv` へ転記し、このファイルは空にする。

## 転記ルール

- 施策スコープ外・他の施策でも再発しうる課題 → **CSV に転記**
- 当施策内だけで完結する軽微な修正メモ → 転記不要（クローズ扱い）
- 転記済みの項目には `[転記済 ISS-XXX]` を末尾に追記してから削除する

---

## 実施ワーカー確認記録

本施策のフェーズ1（T-001〜T-007）実施中に、施策をまたぐ課題は発見されなかった。

**確認日**: 2026-02-25
**確認者**: L2-worker
**結果**: 転記対象なし

---

## 評価ワーカー起票分

### EVL-001: コミットメッセージ規約と既存の Claude Code セッション運用との整合

**発見フェーズ**: T-008 評価（E-2 実用性）
**内容**: ガイドラインで定義されたコミットメッセージ規約 `[<session-type>] <initiative>: <summary>` は、施策に紐づく作業に適した形式である。しかし、施策外の作業（トリアージ、upstream 同期、ルールファイルの単独修正など）でのコミットメッセージ規約が定義されていない。これらの作業は `initiative` パラメータに該当する施策名がないため、現在の規約をそのまま適用できない。
**影響**: ステップ1（即時適用可能）としてコミットメッセージ規約の導入を推奨しているが、施策外コミットのカバーが不足しており、実運用で規約の空白が生じる。
**対応案**: 施策外の作業用のコミットメッセージ形式を追加で定義する（例: `[L1] triage: ...`、`[L1] sync: ...`）か、`initiative` を省略可能にする。
**転記判断**: 転記不要（本施策内で完結する改善提案。ガイドライン改訂時に対応可能）

---

### EVL-002: テスト結果の集約方法が未定義

**発見フェーズ**: T-008 評価（E-1 網羅性、E-3 整合性）
**内容**: worktree ガイドライン（セクション6）では「テスト結果の集約方法」の定義が協調プロトコル施策に期待されているが、ガイドライン文書のセクション4（test プロトコル）にはテスト結果の集約方法（各 worktree でのテスト結果を L1 がどのように収集・判断するか）が明示的に記載されていない。セクション4.3 で「マージ後のフルテスト」に言及はあるが、各 worktree の個別テスト結果の報告・集約の仕組みは未定義である。
**影響**: 並列実行時（ステージ2〜3）にテスト結果の集約手順が不明確になり、L1 のマージ判断に必要な情報が揃わない可能性がある。
**対応案**: test プロトコルにテスト結果報告の形式と L1 への集約方法を追加する。
**転記判断**: 転記不要（本施策内で完結する改善提案。並列実行移行時のガイドライン改訂で対応すべき）

---

### EVL-003: ガイドラインからルールファイルへの組み込みパスが曖昧

**発見フェーズ**: T-008 評価（E-4 段階的導入の妥当性）
**内容**: ガイドライン文書はステップ1（コミットメッセージ規約）が「即時適用可能」としているが、実際にルールファイル（`.claude/rules/`）や CLAUDE.md に反映するための具体的な手順・タイミング・担当（どの施策で行うか）が明確でない。セクション8.3 の将来の検討事項テーブルに「ステージ2 移行時」と記載されているが、ステップ1 は現在の順次実行で即時適用可能と謳っているため、ルール反映のタイミングにギャップがある。
**影響**: 「即時適用可能」と書かれているが実際の適用経路が不明瞭であり、ガイドラインが参照情報のまま放置されるリスクがある。
**対応案**: ステップ1 のルールファイル反映を別施策として起票するか、本ガイドライン内に具体的な反映手順のセクションを追加する。
**転記判断**: CSV に転記 [転記済 ISS-014]

---

### EVL-004: 層3ロックのアトミック性に関する懸念

**発見フェーズ**: T-008 評価（E-2 実用性）
**内容**: 層3（テキストファイルベースの明示的ロック）のロック取得手順は「ロックファイル作成 → git add → git commit → git push → push 成功でロック取得」であるが、Claude Code の Task ツールによるサブエージェント起動では git push が行われない（L1 がまとめて push する）ため、PoC の「push 成功 = ロック取得」の原理が適用できない。サブエージェント環境でのロック取得の代替手段が検討されていない。
**影響**: 層3 は将来の並列実行時（ステージ3）に必要とされているが、実際のアーキテクチャ（Task ツールによるサブエージェント起動）との不一致があり、そのまま実装できない可能性がある。
**対応案**: Task ツール環境でのロック代替手段（ファイルシステムレベルのロック、L1 経由のロック管理など）を検討事項として追記する。
**転記判断**: 転記不要（本施策内の将来検討事項。ステージ3 移行時に具体化すれば足りる）

---

**確認日**: 2026-02-25
**確認者**: L2-evaluator
**結果**: EVL-003 のみ CSV 転記対象
