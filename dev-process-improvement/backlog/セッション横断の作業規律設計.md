# セッション横断の作業規律設計 & OpenSpec コラボレーション

## メタ情報

| 項目 | 内容 |
|------|------|
| **優先度** | 🟡 中 |
| **ステータス** | 候補 |
| **起票日** | 2026-03-01 |

## 課題・背景

施策「シナリオ別セッション運用フロー設計」で5シナリオのセッション運用フローを設計したが、**セッション横断の作業規律**（壁打ち・実施計画・作業ログ・作業レポート・課題起票）が実行層に未導入。

### 現状のギャップ

| レイヤー | 作業規律 | 問題 |
|---------|---------|------|
| 戦略層（dev-process-improvement 施策管理） | 完全（00-08 ファイル、L1/L2 分担） | なし |
| 実行層（5シナリオの開発セッション） | **なし**（git commit のみ） | コンテキスト切れ時の復旧困難、セッション間のトレーサビリティ不在 |

### 壁打ちで合意した方針

1. **段階的作業規律モデル**（3 Tier）:
   - **Tier 1（ライト）**: 単純変更 → ディレクトリ不要、git commit が作業ログを兼ねる
   - **Tier 2（スタンダード）**: 機能開発・設計 → セッションディレクトリ + 管理ファイル
   - **Tier 3（フル）**: 戦略的施策 → 現行 00-08 構造（変更なし）

2. **OpenSpec コラボレーション**:
   - 仕様変更を伴う Tier 2 → `openspec/changes/` 配下に統合。OpenSpec 成果物（proposal/spec/design/tasks）がセッション計画・TODO を兼ねる
   - 仕様変更を伴わない Tier 2 → 独立した `sessions/` ディレクトリに格納

3. **セッション管理ファイルの粒度**: 3ファイル分離（wallbang.md / log.md / report.md）

4. **ディスパッチャーに Tier 判定を追加**: session-operation-flow.md §3 のディスパッチャーが複雑度から Tier を判定

## 期待効果

- 全セッションに比例的な作業規律が適用され、品質トレーサビリティが向上
- OpenSpec 成果物と作業管理ファイルの兼用で、二重管理のオーバーヘッドを回避
- コンテキスト切れ時のセッション復旧が容易になる（壁打ち・ログが残る）
- Tier 判定により、簡単なタスクへの過剰な規律を防止

## 補足・参考情報

- **前提施策**: シナリオ別セッション運用フロー設計（完了）→ `docs/design/session-operation-flow.md`
- **関連施策**: コード開発ワークフロー・ロール定義の実装（ISS-023）— ロール定義にセッション規律を組み込む際にこの施策と連携
- **壁打ちログ**: プランファイル `parsed-dancing-wolf.md` に設計分析と3オプション比較を記録

### 想定される設計対象

1. Tier 判定基準の詳細設計（ディスパッチャー拡張）
2. Tier 2 セッションディレクトリのテンプレート設計
3. OpenSpec changes/ と sessions/ の連携プロトコル
4. Tier 3（施策管理）と Tier 2（開発セッション）の連携ルール
5. session-operation-flow.md §11 への追記（横断的関心事として）

### 想定ディレクトリ構成（Tier 2）

```
# OpenSpec 連携あり（仕様変更を伴う場合）
openspec/changes/<change-name>/
├── .openspec.yaml, proposal.md, specs/, design.md, tasks.md  # OpenSpec 成果物
└── sessions/
    ├── design/
    │   ├── wallbang.md     # 壁打ち記録
    │   ├── log.md          # 作業ログ
    │   └── report.md       # 完了レポート
    └── issues.md           # セッション共通の課題バッファ

# OpenSpec 非連携（仕様変更なしの場合）
sessions/<session-name>/
├── wallbang.md
├── log.md
├── report.md
└── issues.md
```
